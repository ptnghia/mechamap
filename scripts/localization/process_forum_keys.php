<?php
/**
 * Process Forum Translation Keys
 * X·ª≠ l√Ω 129 Forum keys - core functionality
 */

echo "üí¨ PROCESSING FORUM TRANSLATION KEYS\n";
echo "====================================\n\n";

$basePath = '/var/www/mechamap_com_usr/data/www/mechamap.com';

// Bootstrap Laravel
require_once $basePath . '/vendor/autoload.php';
$app = require_once $basePath . '/bootstrap/app.php';
$app->make('Illuminate\Contracts\Console\Kernel')->bootstrap();

// Load analysis data
$analysisFile = $basePath . '/storage/localization/direct_keys_analysis.json';
if (!file_exists($analysisFile)) {
    echo "‚ùå Analysis file not found.\n";
    exit(1);
}

$analysis = json_decode(file_get_contents($analysisFile), true);

// Extract Forum keys
$forumKeys = [];
$allDirectKeys = array_merge(
    $analysis['detailed_patterns']['dot_notation'] ?? [],
    $analysis['detailed_patterns']['slash_notation'] ?? [],
    $analysis['detailed_patterns']['simple_keys'] ?? [],
    $analysis['detailed_patterns']['mixed_notation'] ?? []
);

foreach ($allDirectKeys as $key => $files) {
    if (strpos($key, 'forum.') === 0 || strpos($key, 'forum/') === 0) {
        $forumKeys[$key] = $files;
    }
}

echo "üìä FORUM KEYS ANALYSIS\n";
echo "======================\n";
echo "Total forum keys found: " . count($forumKeys) . "\n";

// Analyze forum key patterns
$forumPatterns = [];
foreach ($forumKeys as $key => $files) {
    // Extract pattern: forum.section.subsection.key
    if (preg_match('/^forum\.([^.]+)\.(.+)$/', $key, $matches)) {
        $section = $matches[1];
        $subkey = $matches[2];
        
        if (!isset($forumPatterns[$section])) {
            $forumPatterns[$section] = [];
        }
        $forumPatterns[$section][$subkey] = [
            'full_key' => $key,
            'files' => $files
        ];
    } elseif (preg_match('/^forum\/([^\/]+)\/(.+)$/', $key, $matches)) {
        $section = $matches[1];
        $subkey = $matches[2];
        
        if (!isset($forumPatterns[$section])) {
            $forumPatterns[$section] = [];
        }
        $forumPatterns[$section][$subkey] = [
            'full_key' => $key,
            'files' => $files
        ];
    }
}

echo "\nüìã FORUM SECTIONS FOUND\n";
echo "=======================\n";
foreach ($forumPatterns as $section => $keys) {
    echo "üî∏ forum.$section: " . count($keys) . " keys\n";
    
    // Show examples
    $examples = array_slice(array_keys($keys), 0, 5);
    foreach ($examples as $example) {
        echo "   - forum.$section.$example\n";
    }
    if (count($keys) > 5) {
        echo "   - ... and " . (count($keys) - 5) . " more\n";
    }
    echo "\n";
}

// Define comprehensive forum translations
$forumTranslations = [
    'threads' => [
        'title' => ['en' => 'Threads', 'vi' => 'Ch·ªß ƒë·ªÅ'],
        'new_thread' => ['en' => 'New Thread', 'vi' => 'Ch·ªß ƒë·ªÅ m·ªõi'],
        'create_thread' => ['en' => 'Create Thread', 'vi' => 'T·∫°o ch·ªß ƒë·ªÅ'],
        'edit_thread' => ['en' => 'Edit Thread', 'vi' => 'Ch·ªânh s·ª≠a ch·ªß ƒë·ªÅ'],
        'delete_thread' => ['en' => 'Delete Thread', 'vi' => 'X√≥a ch·ªß ƒë·ªÅ'],
        'lock_thread' => ['en' => 'Lock Thread', 'vi' => 'Kh√≥a ch·ªß ƒë·ªÅ'],
        'unlock_thread' => ['en' => 'Unlock Thread', 'vi' => 'M·ªü kh√≥a ch·ªß ƒë·ªÅ'],
        'pin_thread' => ['en' => 'Pin Thread', 'vi' => 'Ghim ch·ªß ƒë·ªÅ'],
        'unpin_thread' => ['en' => 'Unpin Thread', 'vi' => 'B·ªè ghim ch·ªß ƒë·ªÅ'],
        'move_thread' => ['en' => 'Move Thread', 'vi' => 'Di chuy·ªÉn ch·ªß ƒë·ªÅ'],
        'merge_thread' => ['en' => 'Merge Thread', 'vi' => 'G·ªôp ch·ªß ƒë·ªÅ'],
        'split_thread' => ['en' => 'Split Thread', 'vi' => 'T√°ch ch·ªß ƒë·ªÅ'],
        'sticky' => ['en' => 'Sticky', 'vi' => 'Ghim'],
        'locked' => ['en' => 'Locked', 'vi' => 'Kh√≥a'],
        'pinned' => ['en' => 'Pinned', 'vi' => 'ƒê√£ ghim'],
        'featured' => ['en' => 'Featured', 'vi' => 'N·ªïi b·∫≠t'],
        'closed' => ['en' => 'Closed', 'vi' => 'ƒê√£ ƒë√≥ng'],
        'open' => ['en' => 'Open', 'vi' => 'M·ªü'],
        'solved' => ['en' => 'Solved', 'vi' => 'ƒê√£ gi·∫£i quy·∫øt'],
        'unsolved' => ['en' => 'Unsolved', 'vi' => 'Ch∆∞a gi·∫£i quy·∫øt'],
        'hot' => ['en' => 'Hot', 'vi' => 'N√≥ng'],
        'trending' => ['en' => 'Trending', 'vi' => 'Xu h∆∞·ªõng'],
        'latest' => ['en' => 'Latest', 'vi' => 'M·ªõi nh·∫•t'],
        'oldest' => ['en' => 'Oldest', 'vi' => 'C≈© nh·∫•t'],
        'most_replies' => ['en' => 'Most Replies', 'vi' => 'Nhi·ªÅu ph·∫£n h·ªìi nh·∫•t'],
        'most_views' => ['en' => 'Most Views', 'vi' => 'Nhi·ªÅu l∆∞·ª£t xem nh·∫•t'],
        'no_replies' => ['en' => 'No Replies', 'vi' => 'Ch∆∞a c√≥ ph·∫£n h·ªìi'],
        'last_post' => ['en' => 'Last Post', 'vi' => 'B√†i vi·∫øt cu·ªëi'],
        'first_post' => ['en' => 'First Post', 'vi' => 'B√†i vi·∫øt ƒë·∫ßu'],
        'thread_starter' => ['en' => 'Thread Starter', 'vi' => 'Ng∆∞·ªùi t·∫°o ch·ªß ƒë·ªÅ'],
        'participants' => ['en' => 'Participants', 'vi' => 'Ng∆∞·ªùi tham gia'],
        'watchers' => ['en' => 'Watchers', 'vi' => 'Ng∆∞·ªùi theo d√µi'],
        'subscribers' => ['en' => 'Subscribers', 'vi' => 'Ng∆∞·ªùi ƒëƒÉng k√Ω'],
        'tags' => ['en' => 'Tags', 'vi' => 'Th·∫ª'],
        'prefix' => ['en' => 'Prefix', 'vi' => 'Ti·ªÅn t·ªë'],
        'category' => ['en' => 'Category', 'vi' => 'Danh m·ª•c'],
        'subcategory' => ['en' => 'Subcategory', 'vi' => 'Danh m·ª•c con'],
        'forum' => ['en' => 'Forum', 'vi' => 'Di·ªÖn ƒë√†n'],
        'subforum' => ['en' => 'Subforum', 'vi' => 'Di·ªÖn ƒë√†n con'],
    ],
    
    'posts' => [
        'title' => ['en' => 'Posts', 'vi' => 'B√†i vi·∫øt'],
        'new_post' => ['en' => 'New Post', 'vi' => 'B√†i vi·∫øt m·ªõi'],
        'reply' => ['en' => 'Reply', 'vi' => 'Tr·∫£ l·ªùi'],
        'quote' => ['en' => 'Quote', 'vi' => 'Tr√≠ch d·∫´n'],
        'edit_post' => ['en' => 'Edit Post', 'vi' => 'Ch·ªânh s·ª≠a b√†i vi·∫øt'],
        'delete_post' => ['en' => 'Delete Post', 'vi' => 'X√≥a b√†i vi·∫øt'],
        'report_post' => ['en' => 'Report Post', 'vi' => 'B√°o c√°o b√†i vi·∫øt'],
        'like_post' => ['en' => 'Like Post', 'vi' => 'Th√≠ch b√†i vi·∫øt'],
        'unlike_post' => ['en' => 'Unlike Post', 'vi' => 'B·ªè th√≠ch b√†i vi·∫øt'],
        'share_post' => ['en' => 'Share Post', 'vi' => 'Chia s·∫ª b√†i vi·∫øt'],
        'bookmark_post' => ['en' => 'Bookmark Post', 'vi' => 'ƒê√°nh d·∫•u b√†i vi·∫øt'],
        'permalink' => ['en' => 'Permalink', 'vi' => 'Li√™n k·∫øt c·ªë ƒë·ªãnh'],
        'post_number' => ['en' => 'Post #', 'vi' => 'B√†i vi·∫øt #'],
        'original_post' => ['en' => 'Original Post', 'vi' => 'B√†i vi·∫øt g·ªëc'],
        'quoted_post' => ['en' => 'Quoted Post', 'vi' => 'B√†i vi·∫øt ƒë∆∞·ª£c tr√≠ch d·∫´n'],
        'edited_by' => ['en' => 'Edited by', 'vi' => 'ƒê∆∞·ª£c ch·ªânh s·ª≠a b·ªüi'],
        'edited_at' => ['en' => 'Edited at', 'vi' => 'Ch·ªânh s·ª≠a l√∫c'],
        'posted_by' => ['en' => 'Posted by', 'vi' => 'ƒêƒÉng b·ªüi'],
        'posted_at' => ['en' => 'Posted at', 'vi' => 'ƒêƒÉng l√∫c'],
        'post_count' => ['en' => 'Post Count', 'vi' => 'S·ªë b√†i vi·∫øt'],
        'reputation' => ['en' => 'Reputation', 'vi' => 'Danh ti·∫øng'],
        'likes_received' => ['en' => 'Likes Received', 'vi' => 'L∆∞·ª£t th√≠ch nh·∫≠n ƒë∆∞·ª£c'],
        'thanks_received' => ['en' => 'Thanks Received', 'vi' => 'L·ªùi c·∫£m ∆°n nh·∫≠n ƒë∆∞·ª£c'],
        'best_answer' => ['en' => 'Best Answer', 'vi' => 'C√¢u tr·∫£ l·ªùi hay nh·∫•t'],
        'mark_as_solution' => ['en' => 'Mark as Solution', 'vi' => 'ƒê√°nh d·∫•u l√† gi·∫£i ph√°p'],
        'unmark_solution' => ['en' => 'Unmark Solution', 'vi' => 'B·ªè ƒë√°nh d·∫•u gi·∫£i ph√°p'],
        'helpful' => ['en' => 'Helpful', 'vi' => 'H·ªØu √≠ch'],
        'not_helpful' => ['en' => 'Not Helpful', 'vi' => 'Kh√¥ng h·ªØu √≠ch'],
        'spam' => ['en' => 'Spam', 'vi' => 'Th∆∞ r√°c'],
        'inappropriate' => ['en' => 'Inappropriate', 'vi' => 'Kh√¥ng ph√π h·ª£p'],
        'off_topic' => ['en' => 'Off Topic', 'vi' => 'L·∫°c ƒë·ªÅ'],
        'duplicate' => ['en' => 'Duplicate', 'vi' => 'Tr√πng l·∫∑p'],
        'low_quality' => ['en' => 'Low Quality', 'vi' => 'Ch·∫•t l∆∞·ª£ng th·∫•p'],
    ],
    
    'poll' => [
        'title' => ['en' => 'Poll', 'vi' => 'Cu·ªôc b√¨nh ch·ªçn'],
        'create_poll' => ['en' => 'Create Poll', 'vi' => 'T·∫°o cu·ªôc b√¨nh ch·ªçn'],
        'edit_poll' => ['en' => 'Edit Poll', 'vi' => 'Ch·ªânh s·ª≠a cu·ªôc b√¨nh ch·ªçn'],
        'delete_poll' => ['en' => 'Delete Poll', 'vi' => 'X√≥a cu·ªôc b√¨nh ch·ªçn'],
        'vote' => ['en' => 'Vote', 'vi' => 'B√¨nh ch·ªçn'],
        'votes' => ['en' => 'vote|votes', 'vi' => 'l∆∞·ª£t b√¨nh ch·ªçn|l∆∞·ª£t b√¨nh ch·ªçn'],
        'change_vote' => ['en' => 'Change Vote', 'vi' => 'Thay ƒë·ªïi phi·∫øu b·∫ßu'],
        'update_vote' => ['en' => 'Update Vote', 'vi' => 'C·∫≠p nh·∫≠t phi·∫øu b·∫ßu'],
        'remove_vote' => ['en' => 'Remove Vote', 'vi' => 'G·ª° b·ªè phi·∫øu b·∫ßu'],
        'view_results' => ['en' => 'View Results', 'vi' => 'Xem k·∫øt qu·∫£'],
        'hide_results' => ['en' => 'Hide Results', 'vi' => '·∫®n k·∫øt qu·∫£'],
        'show_voters' => ['en' => 'Show Voters', 'vi' => 'Hi·ªán ng∆∞·ªùi b√¨nh ch·ªçn'],
        'hide_voters' => ['en' => 'Hide Voters', 'vi' => '·∫®n ng∆∞·ªùi b√¨nh ch·ªçn'],
        'voters' => ['en' => 'Voters', 'vi' => 'Ng∆∞·ªùi b√¨nh ch·ªçn'],
        'total_votes' => ['en' => 'Total Votes', 'vi' => 'T·ªïng s·ªë phi·∫øu'],
        'poll_question' => ['en' => 'Poll Question', 'vi' => 'C√¢u h·ªèi b√¨nh ch·ªçn'],
        'poll_options' => ['en' => 'Poll Options', 'vi' => 'T√πy ch·ªçn b√¨nh ch·ªçn'],
        'add_option' => ['en' => 'Add Option', 'vi' => 'Th√™m t√πy ch·ªçn'],
        'remove_option' => ['en' => 'Remove Option', 'vi' => 'G·ª° b·ªè t√πy ch·ªçn'],
        'multiple_choice' => ['en' => 'Multiple Choice', 'vi' => 'Nhi·ªÅu l·ª±a ch·ªçn'],
        'single_choice' => ['en' => 'Single Choice', 'vi' => 'M·ªôt l·ª±a ch·ªçn'],
        'allow_multiple' => ['en' => 'Allow Multiple Selections', 'vi' => 'Cho ph√©p ch·ªçn nhi·ªÅu'],
        'max_choices' => ['en' => 'Maximum Choices', 'vi' => 'S·ªë l·ª±a ch·ªçn t·ªëi ƒëa'],
        'poll_duration' => ['en' => 'Poll Duration', 'vi' => 'Th·ªùi gian b√¨nh ch·ªçn'],
        'poll_expires' => ['en' => 'Poll Expires', 'vi' => 'Cu·ªôc b√¨nh ch·ªçn h·∫øt h·∫°n'],
        'poll_expired' => ['en' => 'Poll Expired', 'vi' => 'Cu·ªôc b√¨nh ch·ªçn ƒë√£ h·∫øt h·∫°n'],
        'poll_active' => ['en' => 'Poll Active', 'vi' => 'Cu·ªôc b√¨nh ch·ªçn ƒëang ho·∫°t ƒë·ªông'],
        'poll_closed' => ['en' => 'Poll Closed', 'vi' => 'Cu·ªôc b√¨nh ch·ªçn ƒë√£ ƒë√≥ng'],
        'close_poll' => ['en' => 'Close Poll', 'vi' => 'ƒê√≥ng cu·ªôc b√¨nh ch·ªçn'],
        'reopen_poll' => ['en' => 'Reopen Poll', 'vi' => 'M·ªü l·∫°i cu·ªôc b√¨nh ch·ªçn'],
        'anonymous_voting' => ['en' => 'Anonymous Voting', 'vi' => 'B√¨nh ch·ªçn ·∫©n danh'],
        'public_voting' => ['en' => 'Public Voting', 'vi' => 'B√¨nh ch·ªçn c√¥ng khai'],
        'loading_results' => ['en' => 'Loading results...', 'vi' => 'ƒêang t·∫£i k·∫øt qu·∫£...'],
        'no_votes_yet' => ['en' => 'No votes yet', 'vi' => 'Ch∆∞a c√≥ phi·∫øu b·∫ßu n√†o'],
        'you_voted' => ['en' => 'You voted', 'vi' => 'B·∫°n ƒë√£ b√¨nh ch·ªçn'],
        'you_have_not_voted' => ['en' => 'You have not voted', 'vi' => 'B·∫°n ch∆∞a b√¨nh ch·ªçn'],
        'vote_to_see_results' => ['en' => 'Vote to see results', 'vi' => 'B√¨nh ch·ªçn ƒë·ªÉ xem k·∫øt qu·∫£'],
        'percentage' => ['en' => 'Percentage', 'vi' => 'Ph·∫ßn trƒÉm'],
        'vote_count' => ['en' => 'Vote Count', 'vi' => 'S·ªë phi·∫øu b·∫ßu'],
    ],
    
    'categories' => [
        'title' => ['en' => 'Categories', 'vi' => 'Danh m·ª•c'],
        'all_categories' => ['en' => 'All Categories', 'vi' => 'T·∫•t c·∫£ danh m·ª•c'],
        'category' => ['en' => 'Category', 'vi' => 'Danh m·ª•c'],
        'subcategory' => ['en' => 'Subcategory', 'vi' => 'Danh m·ª•c con'],
        'parent_category' => ['en' => 'Parent Category', 'vi' => 'Danh m·ª•c cha'],
        'child_categories' => ['en' => 'Child Categories', 'vi' => 'Danh m·ª•c con'],
        'category_description' => ['en' => 'Category Description', 'vi' => 'M√¥ t·∫£ danh m·ª•c'],
        'category_rules' => ['en' => 'Category Rules', 'vi' => 'Quy t·∫Øc danh m·ª•c'],
        'category_moderators' => ['en' => 'Category Moderators', 'vi' => 'Ng∆∞·ªùi ƒëi·ªÅu h√†nh danh m·ª•c'],
        'threads_count' => ['en' => 'Threads', 'vi' => 'Ch·ªß ƒë·ªÅ'],
        'posts_count' => ['en' => 'Posts', 'vi' => 'B√†i vi·∫øt'],
        'last_activity' => ['en' => 'Last Activity', 'vi' => 'Ho·∫°t ƒë·ªông cu·ªëi'],
        'no_threads' => ['en' => 'No threads in this category', 'vi' => 'Kh√¥ng c√≥ ch·ªß ƒë·ªÅ n√†o trong danh m·ª•c n√†y'],
        'create_first_thread' => ['en' => 'Create the first thread', 'vi' => 'T·∫°o ch·ªß ƒë·ªÅ ƒë·∫ßu ti√™n'],
        'private_category' => ['en' => 'Private Category', 'vi' => 'Danh m·ª•c ri√™ng t∆∞'],
        'public_category' => ['en' => 'Public Category', 'vi' => 'Danh m·ª•c c√¥ng khai'],
        'restricted_category' => ['en' => 'Restricted Category', 'vi' => 'Danh m·ª•c h·∫°n ch·∫ø'],
        'archived_category' => ['en' => 'Archived Category', 'vi' => 'Danh m·ª•c l∆∞u tr·ªØ'],
        'featured_category' => ['en' => 'Featured Category', 'vi' => 'Danh m·ª•c n·ªïi b·∫≠t'],
    ],
    
    'search' => [
        'title' => ['en' => 'Search', 'vi' => 'T√¨m ki·∫øm'],
        'search_forums' => ['en' => 'Search Forums', 'vi' => 'T√¨m ki·∫øm di·ªÖn ƒë√†n'],
        'search_threads' => ['en' => 'Search Threads', 'vi' => 'T√¨m ki·∫øm ch·ªß ƒë·ªÅ'],
        'search_posts' => ['en' => 'Search Posts', 'vi' => 'T√¨m ki·∫øm b√†i vi·∫øt'],
        'search_users' => ['en' => 'Search Users', 'vi' => 'T√¨m ki·∫øm ng∆∞·ªùi d√πng'],
        'search_results' => ['en' => 'Search Results', 'vi' => 'K·∫øt qu·∫£ t√¨m ki·∫øm'],
        'no_results' => ['en' => 'No results found', 'vi' => 'Kh√¥ng t√¨m th·∫•y k·∫øt qu·∫£'],
        'search_query' => ['en' => 'Search Query', 'vi' => 'T·ª´ kh√≥a t√¨m ki·∫øm'],
        'search_in' => ['en' => 'Search in', 'vi' => 'T√¨m ki·∫øm trong'],
        'search_by' => ['en' => 'Search by', 'vi' => 'T√¨m ki·∫øm theo'],
        'search_author' => ['en' => 'Search by Author', 'vi' => 'T√¨m ki·∫øm theo t√°c gi·∫£'],
        'search_date' => ['en' => 'Search by Date', 'vi' => 'T√¨m ki·∫øm theo ng√†y'],
        'search_category' => ['en' => 'Search in Category', 'vi' => 'T√¨m ki·∫øm trong danh m·ª•c'],
        'advanced_search' => ['en' => 'Advanced Search', 'vi' => 'T√¨m ki·∫øm n√¢ng cao'],
        'quick_search' => ['en' => 'Quick Search', 'vi' => 'T√¨m ki·∫øm nhanh'],
        'search_placeholder' => ['en' => 'Search forums...', 'vi' => 'T√¨m ki·∫øm di·ªÖn ƒë√†n...'],
        'search_tips' => ['en' => 'Search Tips', 'vi' => 'M·∫πo t√¨m ki·∫øm'],
        'search_help' => ['en' => 'Search Help', 'vi' => 'Tr·ª£ gi√∫p t√¨m ki·∫øm'],
        'recent_searches' => ['en' => 'Recent Searches', 'vi' => 'T√¨m ki·∫øm g·∫ßn ƒë√¢y'],
        'popular_searches' => ['en' => 'Popular Searches', 'vi' => 'T√¨m ki·∫øm ph·ªï bi·∫øn'],
        'saved_searches' => ['en' => 'Saved Searches', 'vi' => 'T√¨m ki·∫øm ƒë√£ l∆∞u'],
        'save_search' => ['en' => 'Save Search', 'vi' => 'L∆∞u t√¨m ki·∫øm'],
        'delete_search' => ['en' => 'Delete Search', 'vi' => 'X√≥a t√¨m ki·∫øm'],
        'search_filters' => ['en' => 'Search Filters', 'vi' => 'B·ªô l·ªçc t√¨m ki·∫øm'],
        'filter_by_date' => ['en' => 'Filter by Date', 'vi' => 'L·ªçc theo ng√†y'],
        'filter_by_author' => ['en' => 'Filter by Author', 'vi' => 'L·ªçc theo t√°c gi·∫£'],
        'filter_by_category' => ['en' => 'Filter by Category', 'vi' => 'L·ªçc theo danh m·ª•c'],
        'sort_by_relevance' => ['en' => 'Sort by Relevance', 'vi' => 'S·∫Øp x·∫øp theo ƒë·ªô li√™n quan'],
        'sort_by_date' => ['en' => 'Sort by Date', 'vi' => 'S·∫Øp x·∫øp theo ng√†y'],
        'sort_by_replies' => ['en' => 'Sort by Replies', 'vi' => 'S·∫Øp x·∫øp theo ph·∫£n h·ªìi'],
        'sort_by_views' => ['en' => 'Sort by Views', 'vi' => 'S·∫Øp x·∫øp theo l∆∞·ª£t xem'],
    ]
];

echo "\nüîß CREATING FORUM TRANSLATION FILES...\n";
echo "======================================\n";

$createdFiles = 0;
$totalTranslations = 0;

foreach ($forumTranslations as $section => $translations) {
    foreach (['en', 'vi'] as $locale) {
        $filePath = $basePath . "/resources/lang/$locale/forum/$section.php";
        $dirPath = dirname($filePath);
        
        // Create directory if needed
        if (!is_dir($dirPath)) {
            mkdir($dirPath, 0755, true);
            echo "üìÅ Created directory: " . str_replace($basePath . '/', '', $dirPath) . "\n";
        }
        
        // Load existing translations
        $existingTranslations = [];
        if (file_exists($filePath)) {
            $existingTranslations = include $filePath;
            if (!is_array($existingTranslations)) {
                $existingTranslations = [];
            }
        }
        
        // Add new translations
        $newTranslations = [];
        foreach ($translations as $key => $localeTranslations) {
            $newTranslations[$key] = $localeTranslations[$locale];
        }
        
        // Merge with existing
        $mergedTranslations = array_merge($existingTranslations, $newTranslations);
        
        // Generate file content
        $fileContent = "<?php\n\n/**\n * Forum $section translations\n * Updated: " . date('Y-m-d H:i:s') . "\n */\n\nreturn " . var_export($mergedTranslations, true) . ";\n";
        
        // Save file
        file_put_contents($filePath, $fileContent);
        
        echo "‚úÖ Updated: $locale/forum/$section.php (" . count($newTranslations) . " translations)\n";
        $createdFiles++;
        $totalTranslations += count($newTranslations);
    }
}

echo "\nüìä SUMMARY\n";
echo "==========\n";
echo "Forum sections processed: " . count($forumTranslations) . "\n";
echo "Translation files created/updated: $createdFiles\n";
echo "Total translations added: $totalTranslations\n";

// Clear caches
echo "\nüßπ CLEARING CACHES...\n";
echo "=====================\n";

$commands = [
    'php artisan cache:clear',
    'php artisan view:clear',
    'php artisan config:clear'
];

foreach ($commands as $command) {
    echo "Running: $command\n";
    $output = shell_exec("cd $basePath && $command 2>&1");
    echo "   " . trim($output) . "\n";
}

echo "\nüß™ TESTING FORUM KEYS...\n";
echo "========================\n";

$testForumKeys = [
    'forum.threads.title',
    'forum.threads.sticky',
    'forum.threads.locked',
    'forum.posts.reply',
    'forum.poll.vote',
    'forum.poll.votes',
    'forum.poll.total_votes',
    'forum.categories.title',
    'forum.search.title'
];

$workingCount = 0;
foreach ($testForumKeys as $key) {
    $result = __($key);
    if ($result !== $key) {
        echo "‚úÖ __('$key') ‚Üí '$result'\n";
        $workingCount++;
    } else {
        echo "‚ùå __('$key') - Not found\n";
    }
}

echo "\nForum keys success rate: " . round(($workingCount / count($testForumKeys)) * 100, 1) . "%\n";

echo "\nüéØ NEXT STEPS\n";
echo "=============\n";
echo "1. ‚úÖ Created comprehensive forum translations\n";
echo "2. üîÑ Process auth keys (138 keys) next\n";
echo "3. üîÑ Run comprehensive validation to see overall improvement\n";
echo "4. üîÑ Test critical forum functionality in browser\n";
echo "5. üîÑ Consider processing remaining categories\n\n";

echo "üí° IMPACT ASSESSMENT\n";
echo "====================\n";
echo "Forum keys are core functionality - success here improves user engagement.\n";
echo "Poll functionality should now work better with proper translations.\n";
echo "Thread and post management should display proper labels.\n";
